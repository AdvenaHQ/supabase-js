import"server-only";import{log as o}from"../../helpers/log";import{globalOptions as r}from"../index";const d=async(a,c)=>{if(r?.cache?.provider!=="supacache")return o("\u26A0\uFE0F The cache provider is not configured for supacache. Please check the configuration. Falling back to default fetch.","warn",!0),fetch(a,c);const e={url:new URL(a),method:c?.method||"GET",headers:new Headers(c?.headers)},s=new URL(r?.cache?.supacache?.url);if(e.method==="GET"){const h=new Headers({...Object.fromEntries(e?.headers?.entries()),...r?.config?.global?.headers||{}});return(e.url.hostname.includes(s.hostname)||e.url.hostname.includes(".supabase.co"))&&(e.url.hostname=s.hostname),h.set("x-cache-service-key",r?.cache?.supacache?.serviceKey),fetch(e.url,{...c,headers:h})}return fetch(a,c)};export{d as SupacacheCacheProviderFetch};
//# sourceMappingURL=supacache.js.map
